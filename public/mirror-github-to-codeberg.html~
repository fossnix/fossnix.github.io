<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- Jul 29, 2021 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Mirroring Github repos to Codeberg</title>
<meta name="generator" content="Org mode" />
<meta name="author" content="Arya K" />
<link rel='icon' type='image/x-icon' href='/images/favicon.jpg'/>
<meta name='viewport' content='width=device-width, initial-scale=1'>
<link rel='stylesheet' href='https://code.cdn.mozilla.net/fonts/fira.css'>
<link rel='stylesheet' href='/css/site.css?v=2' type='text/css'/>
<link rel='stylesheet' href='/css/custom.css' type='text/css'/>
<link rel='stylesheet' href='/css/syntax-coloring.css' type='text/css'/>
<script type="text/javascript">
// @license magnet:?xt=urn:btih:1f739d935676111cfff4b4693e3816e664797050&amp;dn=gpl-3.0.txt GPL-v3-or-Later
<!--/*--><![CDATA[/*><!--*/
     function CodeHighlightOn(elem, id)
     {
       var target = document.getElementById(id);
       if(null != target) {
         elem.classList.add("code-highlighted");
         target.classList.add("code-highlighted");
       }
     }
     function CodeHighlightOff(elem, id)
     {
       var target = document.getElementById(id);
       if(null != target) {
         elem.classList.remove("code-highlighted");
         target.classList.remove("code-highlighted");
       }
     }
    /*]]>*///-->
// @license-end
</script>
</head>
<body>
<div id="org-div-home-and-up">
 <a accesskey="h" href="/"> UP </a>
 |
 <a accesskey="H" href="/"> HOME </a>
</div><header id="top" class="status">
<div class='intro'>
  <img src='/images/about/profile.png' alt='FOSS Nix' class='no-border'/>
  <h1>
    <span class="gray">FOSS</span>
    <span class="black">Nix</span>
  </h1>
  <p>The Blog for all your FOSS</p>
</div>

<div class='nav'>
<ul>
<li><a href='/'>Blog</a>.</li>
<!-- <li><a href='http://codeberg.org/aryak'>Codeberg</a>.</li>-->
<li><a href='/tags/'>Tags</a>.</li>
<li><a href='http://github.com/FOSSNIX'>GitHub</a>.</li>
<li><a href='/index.xml'>RSS</a>.</li>
<li><a href='/about/'>About</a></li>
</ul>
</div>
</header>
<main id="content">
<h1 class="title">Mirroring Github repos to Codeberg
<br />
<span class="subtitle">Published on Jul 17, 2021 by Arya K.</span>
</h1>
<p>
There are many reasons you might want to mirror your github repo to codeberg.
</p>

<p>
For example you don&rsquo;t want your users to be connecting to M$ servers.
</p>

<p>
But you still want your repo on github for the better discoverability
</p>

<p>
Its having your cake and eating it too
</p>

<p>
Here is how you do it
</p>

<section id="outline-container-org27b355a" class="outline-2">
<h2 id="org27b355a">Preparing for the mirroring</h2>
<div class="outline-text-2" id="text-org27b355a">
<p>
First create an account @ codeberg.org
</p>

<p>
Then in the dashboard click on the + icon at the top of the UI and click New Migration from the dropdown.
</p>

<p>
In This menu chose github as we are migrating the repo from github.
</p>

<p>
This will just give a clone of the repo and not delete it.
</p>

<p>
The instructions for gitlab and self hosted git repos will be very similar.
</p>

<p>
Type in your github repo&rsquo;s clone url.
</p>

<p>
Note: Make sure there is a .git at the end of the url.
</p>

<p>
If you want your Pull Requests and other data, you can type in a personal access token.
</p>

<p>
This will be the same for gitlab.
</p>

<p>
For Normal git instance type in the login credentials.
</p>

<p>
Then click create repository.
</p>

<p>
Now clone the repo hosted on github
</p>
</div>
</section>

<section id="outline-container-org74e0df9" class="outline-2">
<h2 id="org74e0df9">Repository Mirroring</h2>
<div class="outline-text-2" id="text-org74e0df9">
<p>
There are 2 ways to do the mirroring
</p>
</div>
<div id="outline-container-org256c030" class="outline-3">
<h3 id="org256c030">Option 1: Via git command line</h3>
<div class="outline-text-3" id="text-org256c030">
</div>
<div id="outline-container-org0894e11" class="outline-4">
<h4 id="org0894e11">Adding seperate remote for github and codeberg (Optional)</h4>
<div class="outline-text-4" id="text-org0894e11">
<p>
This is useful if you want to push specific changes to one service.
</p>
</div>
<ul class="org-ul">
<li><a id="org4c9053c"></a>Github<br />
<div class="outline-text-5" id="text-org4c9053c">
<p>
Replace user with your username and repo with the name of your repo if it isn&rsquo;t obvious aldready.
</p>
<div class="org-src-container">
<pre class="src src-sh">git remote add github https://github.com/user/repo.git
</pre>
</div>
<p>
If you prefer git via ssh you can use git@github.com:user/repo.git 
</p>
</div>
</li>
<li><a id="org39de631"></a>Codeberg<br />
<div class="outline-text-5" id="text-org39de631">
<p>
Replace user with your username and repo with the name of your repo if it isn&rsquo;t obvious aldready.
</p>
<div class="org-src-container">
<pre class="src src-sh">git remote add codeberg https://codeberg.org/user/repo.git
</pre>
</div>
<p>
If you prefer git via ssh you can use git@codeberg.org:user/repo.git
</p>
</div>
</li>
<li><a id="org1ed3a37"></a>List the remotes<br />
<div class="outline-text-5" id="text-org1ed3a37">
<p>
For Seeing if the command succeeded, you can use the following command
</p>
<div class="org-src-container">
<pre class="src src-sh">git remote -v
</pre>
</div>
<p>
You Should see something like this
</p>

<p>
codeberg	<a href="https://codeberg.org/user/repo.git">https://codeberg.org/user/repo.git</a> (fetch)
</p>

<p>
codeberg	<a href="https://codeberg.org/user/repo.git">https://codeberg.org/user/repo.git</a> (push)
</p>

<p>
github	<a href="https://github.com/user/repo.git">https://github.com/user/repo.git</a> (fetch)
</p>

<p>
github	<a href="https://github.com/user/repo.git">https://github.com/user/repo.git</a> (push)
</p>

<p>
origin	<a href="https://github.com/user/repo.git">https://github.com/user/repo.git</a> (fetch)
</p>

<p>
origin	<a href="https://github.com/user/repo.git">https://github.com/user/repo.git</a> (push)
</p>
</div>
</li>
</ul>
</div>
<div id="outline-container-orgc205d68" class="outline-4">
<h4 id="orgc205d68">Adding codeberg to origin so it pushes to it too when we do git push</h4>
<div class="outline-text-4" id="text-orgc205d68">
<p>
Right now when you do git push with no args, it will only push to github
</p>

<p>
Lets make it such that it uploads to codeberg too!
</p>
<div class="org-src-container">
<pre class="src src-sh">git remote set-url --add --push origin https://codeberg.org/user/repo.git
</pre>
</div>

<p>
Now when you push it will push it to both codeberg and github
</p>
</div>
</div>
</div>
<div id="outline-container-org7e72222" class="outline-3">
<h3 id="org7e72222">Option 2: Via git config file</h3>
<div class="outline-text-3" id="text-org7e72222">
<p>
There is a file called config located in the .git directory of your repo
</p>

<p>
It is where all the stuff we manipulate via commands go.
</p>

<p>
We can also directly manipulate it
</p>

<p>
cd into .git and open config in your favourite editor
</p>

<p>
and override the file with the following contents
</p>


<p>
Replace user with your username and repo with the name of your repo if it isn&rsquo;t obvious aldready.
</p>
<pre class="example" id="org726975b">
[core]
    repositoryformatversion = 0
    filemode = true
    bare = false
    logallrefupdates = true
[remote "github"]
    url = https://github.com/user/repo.git
    fetch = +refs/heads/*:refs/remotes/github/*
[remote "codeberg"]
    url = https://codeberg.org/user/repo.git
    fetch = +refs/heads/*:refs/remotes/codeberg/*
[remote "origin"]
    url = https://github.com/user/repo.git
    fetch = +refs/heads/*:refs/remotes/origin/*
    pushurl = https://github.com/user/repo.git
    pushurl = https://codeberg.org/user/repo.git
[branch "main"]
    remote = origin
    merge = refs/heads/main
    pushRemote = origin
</pre>
</div>
</div>
</section>

<section id="outline-container-org213f1b6" class="outline-2">
<h2 id="org213f1b6">Testing</h2>
<div class="outline-text-2" id="text-org213f1b6">
<p>
Now comes the fun part, testing if it works
</p>

<p>
Try doing a git push to the repo
</p>

<p>
Now check both codeberg and github and it should have updated
</p>
</div>
</section>
<section id="outline-container-orga5a11ad" class="outline-2">
<h2 id="orga5a11ad">Problems</h2>
<div class="outline-text-2" id="text-orga5a11ad">
<p>
If you have any issues with this, please <a href="mailto:aryakiran@zohomail.eu">email me</a> 
</p>

<div id="HCB_comment_box"><a href="http://www.htmlcommentbox.com">HTML Comment Box</a> is loading comments...</div>  <link rel="stylesheet" type="text/css" href="https://www.htmlcommentbox.com/static/skins/bootstrap/twitter-bootstrap.css?v=0" /> <script type="text/javascript" id="hcb"> /*<!--*/ if(!window.hcb_user){hcb_user={};} (function(){var s=document.createElement("script"), l=hcb_user.PAGE || (""+window.location).replace(/'/g,"%27"), h="https://www.htmlcommentbox.com";s.setAttribute("type","text/javascript");s.setAttribute("src", h+"/jread?page="+encodeURIComponent(l).replace("+","%2B")+"&mod=%241%24wq1rdBcg%24.0WYnR7CBBV5ruABxgEC.%2F"+"&opts=16798&num=10&ts=1626511120600");if (typeof s!="undefined") document.getElementsByTagName("head")[0].appendChild(s);})(); /*-->*/ </script>
</div>
</section>
</main>
<footer id="postamble" class="status">
<div class='footer'>
	<!--	<a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-nc-sa/4.0/88x31.png" /></a><br />This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/">Creative Commons Attribution-NonCommercial-ShareAlike 4.0 International License</a>.<br> -->
  Last updated on Jul 29, 2021. Generated using <a href="https://www.gnu.org/software/emacs/">Emacs</a> 27.2 (<a href="https://orgmode.org">Org</a> mode 9.4.6).
</div>
</footer>
</body>
</html>
